{"ast":null,"code":"import _regeneratorRuntime from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _defineProperty from\"/fabric_explorer_nft/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";/**\n *    SPDX-License-Identifier: Apache-2.0\n */import React,{Component}from'react';import{connect}from'react-redux';import{withStyles}from'@material-ui/core/styles';import Avatar from'@material-ui/core/Avatar';import Button from'@material-ui/core/Button';import FormControl from'@material-ui/core/FormControl';import FormHelperText from'@material-ui/core/FormHelperText';import InputAdornment from'@material-ui/core/InputAdornment';import TextField from'@material-ui/core/TextField';import Paper from'@material-ui/core/Paper';import Typography from'@material-ui/core/Typography';import MenuItem from'@material-ui/core/MenuItem';import ListIcon from'@material-ui/icons/List';import PersonIcon from'@material-ui/icons/Person';import LockOutlinedIcon from'@material-ui/icons/LockOutlined';import{authSelectors,authOperations}from'../../state/redux/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var styles=function styles(theme){return{container:_defineProperty({width:'auto',display:'block',// Fix IE 11 issue.\nmarginLeft:theme.spacing.unit*3,marginRight:theme.spacing.unit*3},theme.breakpoints.up(400+theme.spacing.unit*3*2),{width:400,marginLeft:'auto',marginRight:'auto'}),paper:{marginTop:theme.spacing.unit*8,display:'flex',flexDirection:'column',alignItems:'center',padding:\"\".concat(theme.spacing.unit*2,\"px \").concat(theme.spacing.unit*3,\"px \").concat(theme.spacing.unit*3,\"px\")},avatar:{margin:theme.spacing.unit,backgroundColor:theme.palette.secondary.main},form:{width:'100%',// Fix IE 11 issue.\nmarginTop:theme.spacing.unit},submit:{marginTop:theme.spacing.unit*3},errortext:{fontSize:16,font:'bold',color:'red'}};};export var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.handleChange=function(event){var target=event.target;var value=target.type==='checkbox'?target.checked:target.value;var name=target.name;var newState=_defineProperty({},name,{value:value});if(name==='network'){var networks=_this.state.networks;newState.authEnabled=(networks.find(function(n){return n.name===value;})||{}).authEnabled;newState.network.id=(networks.find(function(n){return n.name===value;})||{}).id;}_this.setState(newState);};_this.submitForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _this$state,user,password,network;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_this$state=_this.state,user=_this$state.user,password=_this$state.password,network=_this$state.network;_context.next=4;return _this.performLogin({user:user.value,password:password.value,network:network.id});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();var _props$networks=props.networks,_networks=_props$networks===void 0?[]:_props$networks;_this.state={info:null,user:{error:null,value:''},password:{error:null,value:''},network:{error:null,value:'',id:''},autoLoginAttempted:false,error:'',networks:_networks,authEnabled:false,isLoading:false};return _this;}_createClass(Login,[{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(nextProps){var _nextProps$networks=nextProps.networks,networks=_nextProps$networks===void 0?[]:_nextProps$networks;this.setState(function(){return{networks:networks,network:{error:null,value:networks[0].name||'',id:networks[0].id},authEnabled:networks[0].authEnabled};});}},{key:\"performLogin\",value:function(){var _performLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2){var user,password,network,login,authEnabled,info,history;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:user=_ref2.user,password=_ref2.password,network=_ref2.network;login=this.props.login;authEnabled=this.state.authEnabled;_context2.next=5;return login({user:authEnabled?user:'dummy-user',password:authEnabled?password:'dummy-password'},network);case 5:info=_context2.sent;this.setState(function(){return{info:info};});if(!(info.status==='Success')){_context2.next=11;break;}history=this.props.history;history.replace('/');return _context2.abrupt(\"return\",true);case 11:case\"end\":return _context2.stop();}}},_callee2,this);}));function performLogin(_x2){return _performLogin.apply(this,arguments);}return performLogin;}()},{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this$state2,networks,autoLoginAttempted;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$state2=this.state,networks=_this$state2.networks,autoLoginAttempted=_this$state2.autoLoginAttempted;/*\n\t\t * If we have only one network and it doesn't have auth enabled, perform a login\n\t\t * autoLoginAttempted is a safety to prevent multiple tries\n\t\t */if(!(networks.length===1&&!networks[0].authEnabled&&!autoLoginAttempted)){_context3.next=5;break;}// eslint-disable-next-line react/no-did-update-set-state\nthis.setState(function(){return{autoLoginAttempted:true};});_context3.next=5;return this.performLogin({network:networks[0].id});case 5:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidUpdate(){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"render\",value:function render(){var _this2=this;var _this$state3=this.state,info=_this$state3.info,user=_this$state3.user,password=_this$state3.password,network=_this$state3.network,networks=_this$state3.networks,authEnabled=_this$state3.authEnabled,isLoading=_this$state3.isLoading;var _this$props=this.props,classes=_this$props.classes,error=_this$props.error;return/*#__PURE__*/_jsx(\"div\",{className:classes.container,children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.avatar,children:/*#__PURE__*/_jsx(LockOutlinedIcon,{})}),/*#__PURE__*/_jsx(Typography,{component:\"h5\",variant:\"headline\",children:\"Sign in\"}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:this.submitForm,children:[/*#__PURE__*/_jsxs(FormControl,{margin:\"normal\",required:true,fullWidth:true,children:[/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,select:true,id:\"network\",name:\"network\",label:\"Network\",disabled:isLoading,value:network.value,onChange:function onChange(e){return _this2.handleChange(e);},margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(ListIcon,{})}),shrink:'true'},children:networks.map(function(item){return/*#__PURE__*/_jsx(MenuItem,{value:item.name,children:item.name},item.name);})}),network.error&&/*#__PURE__*/_jsx(FormHelperText,{id:\"component-error-text\",error:true,children:network.error})]}),authEnabled&&/*#__PURE__*/_jsxs(FormControl,{margin:\"normal\",required:true,fullWidth:true,children:[/*#__PURE__*/_jsx(TextField,{error:!!user.error,required:true,fullWidth:true,id:\"user\",name:\"user\",label:\"User\",disabled:isLoading,value:user.value,onChange:function onChange(e){return _this2.handleChange(e);},margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(PersonIcon,{})}),shrink:'true'}}),user.error&&/*#__PURE__*/_jsx(FormHelperText,{id:\"component-error-text\",error:true,children:user.error})]}),authEnabled&&/*#__PURE__*/_jsxs(FormControl,{margin:\"normal\",required:true,fullWidth:true,children:[/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,error:!!password.error,id:\"password\",type:\"password\",name:\"password\",label:\"Password\",disabled:isLoading,value:password.value,onChange:function onChange(e){return _this2.handleChange(e);},margin:\"normal\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(LockOutlinedIcon,{})}),shrink:'true'}}),password.error&&/*#__PURE__*/_jsx(FormHelperText,{id:\"component-error-text\",error:true,children:password.error})]}),error&&/*#__PURE__*/_jsx(FormHelperText,{id:\"component-error-text\",error:true,children:error}),info&&/*#__PURE__*/_jsx(FormHelperText,{id:\"component-error-text\",className:classes.errortext,children:info.message}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,children:authEnabled?'Sign in':'Connect'})]})]})});}}]);return Login;}(Component);var authSelector=authSelectors.authSelector,errorSelector=authSelectors.errorSelector,networkSelector=authSelectors.networkSelector;var mapStateToProps=function mapStateToProps(state){return{auth:authSelector(state),error:errorSelector(state),networks:networkSelector(state)};};var mapDispatchToProps={login:authOperations.login};var connectedComponent=connect(mapStateToProps,mapDispatchToProps)(Login);export default withStyles(styles)(connectedComponent);","map":{"version":3,"sources":["/fabric_explorer_nft/client/src/components/Login/Login.js"],"names":["React","Component","connect","withStyles","Avatar","Button","FormControl","FormHelperText","InputAdornment","TextField","Paper","Typography","MenuItem","ListIcon","PersonIcon","LockOutlinedIcon","authSelectors","authOperations","styles","theme","container","width","display","marginLeft","spacing","unit","marginRight","breakpoints","up","paper","marginTop","flexDirection","alignItems","padding","avatar","margin","backgroundColor","palette","secondary","main","form","submit","errortext","fontSize","font","color","Login","props","handleChange","event","target","value","type","checked","name","newState","networks","state","authEnabled","find","n","network","id","setState","submitForm","e","preventDefault","user","password","performLogin","info","error","autoLoginAttempted","isLoading","nextProps","login","status","history","replace","length","classes","startAdornment","shrink","map","item","message","authSelector","errorSelector","networkSelector","mapStateToProps","auth","mapDispatchToProps","connectedComponent"],"mappings":"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","sourcesContent":["/**\n *    SPDX-License-Identifier: Apache-2.0\n */\n\nimport React, { Component } from 'react';\n\nimport { connect } from 'react-redux';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport ListIcon from '@material-ui/icons/List';\nimport PersonIcon from '@material-ui/icons/Person';\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\n\nimport { shape, string } from 'prop-types';\n\nimport { authSelectors, authOperations } from '../../state/redux/auth';\n\nconst styles = theme => ({\n\tcontainer: {\n\t\twidth: 'auto',\n\t\tdisplay: 'block', // Fix IE 11 issue.\n\t\tmarginLeft: theme.spacing.unit * 3,\n\t\tmarginRight: theme.spacing.unit * 3,\n\t\t[theme.breakpoints.up(400 + theme.spacing.unit * 3 * 2)]: {\n\t\t\twidth: 400,\n\t\t\tmarginLeft: 'auto',\n\t\t\tmarginRight: 'auto'\n\t\t}\n\t},\n\tpaper: {\n\t\tmarginTop: theme.spacing.unit * 8,\n\t\tdisplay: 'flex',\n\t\tflexDirection: 'column',\n\t\talignItems: 'center',\n\t\tpadding: `${theme.spacing.unit * 2}px ${theme.spacing.unit * 3}px ${theme\n\t\t\t.spacing.unit * 3}px`\n\t},\n\tavatar: {\n\t\tmargin: theme.spacing.unit,\n\t\tbackgroundColor: theme.palette.secondary.main\n\t},\n\tform: {\n\t\twidth: '100%', // Fix IE 11 issue.\n\t\tmarginTop: theme.spacing.unit\n\t},\n\tsubmit: {\n\t\tmarginTop: theme.spacing.unit * 3\n\t},\n\terrortext: {\n\t\tfontSize: 16,\n\t\tfont: 'bold',\n\t\tcolor: 'red'\n\t}\n});\n\nexport class Login extends Component {\n\tstatic propTypes = {\n\t\tclasses: shape({\n\t\t\tavatar: string,\n\t\t\tform: string,\n\t\t\tcontainer: string,\n\t\t\tpaper: string,\n\t\t\tsubmit: string\n\t\t}).isRequired\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst { networks = [] } = props;\n\t\tthis.state = {\n\t\t\tinfo: null,\n\t\t\tuser: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tpassword: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tnetwork: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: '',\n\t\t\t\tid: ''\n\t\t\t},\n\t\t\tautoLoginAttempted: false,\n\t\t\terror: '',\n\t\t\tnetworks,\n\t\t\tauthEnabled: false,\n\t\t\tisLoading: false\n\t\t};\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tconst { networks = [] } = nextProps;\n\t\tthis.setState(() => ({\n\t\t\tnetworks,\n\t\t\tnetwork: {\n\t\t\t\terror: null,\n\t\t\t\tvalue: networks[0].name || '',\n\t\t\t\tid: networks[0].id\n\t\t\t},\n\t\t\tauthEnabled: networks[0].authEnabled\n\t\t}));\n\t}\n\n\thandleChange = event => {\n\t\tconst { target } = event;\n\t\tconst value = target.type === 'checkbox' ? target.checked : target.value;\n\t\tconst { name } = target;\n\n\t\tconst newState = {\n\t\t\t[name]: { value }\n\t\t};\n\t\tif (name === 'network') {\n\t\t\tconst { networks } = this.state;\n\t\t\tnewState.authEnabled = (\n\t\t\t\tnetworks.find(n => n.name === value) || {}\n\t\t\t).authEnabled;\n\t\t\tnewState.network.id = (networks.find(n => n.name === value) || {}).id;\n\t\t}\n\n\t\tthis.setState(newState);\n\t};\n\n\tasync performLogin({ user, password, network }) {\n\t\tconst { login } = this.props;\n\t\tconst { authEnabled } = this.state;\n\n\t\tconst info = await login(\n\t\t\t{\n\t\t\t\tuser: authEnabled ? user : 'dummy-user',\n\t\t\t\tpassword: authEnabled ? password : 'dummy-password'\n\t\t\t},\n\t\t\tnetwork\n\t\t);\n\n\t\tthis.setState(() => ({ info }));\n\t\tif (info.status === 'Success') {\n\t\t\tconst { history } = this.props;\n\t\t\thistory.replace('/');\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tsubmitForm = async e => {\n\t\te.preventDefault();\n\n\t\tconst { user, password, network } = this.state;\n\n\t\tawait this.performLogin({\n\t\t\tuser: user.value,\n\t\t\tpassword: password.value,\n\t\t\tnetwork: network.id\n\t\t});\n\t};\n\n\tasync componentDidUpdate() {\n\t\tconst { networks, autoLoginAttempted } = this.state;\n\n\t\t/*\n\t\t * If we have only one network and it doesn't have auth enabled, perform a login\n\t\t * autoLoginAttempted is a safety to prevent multiple tries\n\t\t */\n\t\tif (\n\t\t\tnetworks.length === 1 &&\n\t\t\t!networks[0].authEnabled &&\n\t\t\t!autoLoginAttempted\n\t\t) {\n\t\t\t// eslint-disable-next-line react/no-did-update-set-state\n\t\t\tthis.setState(() => ({\n\t\t\t\tautoLoginAttempted: true\n\t\t\t}));\n\t\t\tawait this.performLogin({ network: networks[0].id });\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tinfo,\n\t\t\tuser,\n\t\t\tpassword,\n\t\t\tnetwork,\n\t\t\tnetworks,\n\t\t\tauthEnabled,\n\t\t\tisLoading\n\t\t} = this.state;\n\t\tconst { classes, error } = this.props;\n\n\t\treturn (\n\t\t\t<div className={classes.container}>\n\t\t\t\t<Paper className={classes.paper}>\n\t\t\t\t\t<Avatar className={classes.avatar}>\n\t\t\t\t\t\t<LockOutlinedIcon />\n\t\t\t\t\t</Avatar>\n\t\t\t\t\t<Typography component=\"h5\" variant=\"headline\">\n\t\t\t\t\t\tSign in\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<form className={classes.form} onSubmit={this.submitForm}>\n\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tselect\n\t\t\t\t\t\t\t\tid=\"network\"\n\t\t\t\t\t\t\t\tname=\"network\"\n\t\t\t\t\t\t\t\tlabel=\"Network\"\n\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\tvalue={network.value}\n\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t<ListIcon />\n\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{networks.map(item => (\n\t\t\t\t\t\t\t\t\t<MenuItem key={item.name} value={item.name}>\n\t\t\t\t\t\t\t\t\t\t{item.name}\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TextField>\n\t\t\t\t\t\t\t{network.error && (\n\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t{network.error}\n\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t{authEnabled && (\n\t\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\terror={!!user.error}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\tid=\"user\"\n\t\t\t\t\t\t\t\t\tname=\"user\"\n\t\t\t\t\t\t\t\t\tlabel=\"User\"\n\t\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\t\tvalue={user.value}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t\t<PersonIcon />\n\t\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{user.error && (\n\t\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t\t{user.error}\n\t\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{authEnabled && (\n\t\t\t\t\t\t\t<FormControl margin=\"normal\" required fullWidth>\n\t\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\t\terror={!!password.error}\n\t\t\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\t\t\tvalue={password.value}\n\t\t\t\t\t\t\t\t\tonChange={e => this.handleChange(e)}\n\t\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\t\t\tstartAdornment: (\n\t\t\t\t\t\t\t\t\t\t\t<InputAdornment position=\"start\">\n\t\t\t\t\t\t\t\t\t\t\t\t<LockOutlinedIcon />\n\t\t\t\t\t\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\tshrink: 'true'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{password.error && (\n\t\t\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t\t\t{password.error}\n\t\t\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{error && (\n\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" error>\n\t\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{info && (\n\t\t\t\t\t\t\t<FormHelperText id=\"component-error-text\" className={classes.errortext}>\n\t\t\t\t\t\t\t\t{info.message}\n\t\t\t\t\t\t\t</FormHelperText>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\tclassName={classes.submit}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{authEnabled ? 'Sign in' : 'Connect'}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\t\t\t\t</Paper>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst { authSelector, errorSelector, networkSelector } = authSelectors;\n\nconst mapStateToProps = state => {\n\treturn {\n\t\tauth: authSelector(state),\n\t\terror: errorSelector(state),\n\t\tnetworks: networkSelector(state)\n\t};\n};\n\nconst mapDispatchToProps = {\n\tlogin: authOperations.login\n};\n\nconst connectedComponent = connect(mapStateToProps, mapDispatchToProps)(Login);\nexport default withStyles(styles)(connectedComponent);\n"]},"metadata":{},"sourceType":"module"}